default_username='mjyc'

# Ensure 256 color support
export TERM="xterm-256color"

# Define Colors using tput
if tput setaf 1 &> /dev/null; then
    MAGENTA=$(tput setaf 9)
    ORANGE=$(tput setaf 172)
    GREEN=$(tput setaf 2)
    PURPLE=$(tput setaf 141)
    WHITE=$(tput setaf 7)
    BOLD=$(tput bold)
    RESET=$(tput sgr0)
else
    MAGENTA="\033[1;31m"
    ORANGE="\033[1;33m"
    GREEN="\033[1;32m"
    PURPLE="\033[1;35m"
    WHITE="\033[1;37m"
    BOLD=""
    RESET="\033[m"
fi

# Only show username if it's not the default user
function usernamehost() {
    if [[ "$USER" != "$default_username" ]]; then
        echo "${MAGENTA}${USER}${WHITE} at ${ORANGE}${HOSTNAME%%.*} ${WHITE}in "
    else
        echo "${ORANGE}${HOSTNAME%%.*} ${WHITE}in "
    fi
}

# Git status info
function git_info() {
    # Check if we're in a git repo
    git rev-parse --is-inside-work-tree &>/dev/null || return

    # Get branch name
    local branch=$(git symbolic-ref -q HEAD | sed -e 's|^refs/heads/||')
    
    # Check if dirty (changes exist)
    local dirty=""
    git diff --quiet --ignore-submodules HEAD &>/dev/null || dirty="*"

    echo "${WHITE} on ${PURPLE}${branch}${dirty}"
}

# Final Prompt Construction
# \w = full path, \W = current folder only. Using \w for clarity.
export PS1="\[$BOLD\]\$(usernamehost)\[$GREEN\]\w\$(git_info)\[$WHITE\]\n\$ \[$RESET\]"
